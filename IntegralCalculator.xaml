<Window x:Class="MultiWindowApp.IntegralCalculator"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Вычисление определенного интеграла - Лабораторная работа №5" 
        Height="900" Width="1400"
        WindowStartupLocation="CenterScreen"
        Background="White"
        Closing="Window_Closing">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="180"/>
        </Grid.RowDefinitions>

        <!-- Меню -->
        <Menu Grid.Row="0" Background="#FF0078D7" Padding="0">
            <MenuItem Header="Файл" Foreground="White" FontWeight="SemiBold">
                <MenuItem Header="Очистить" Background="#FF0078D7" Click="ClearButton_Click"/>
                <Separator/>
                <MenuItem Header="Выход" Background="#FF0078D7" Click="ExitButton_Click"/>
            </MenuItem>
            <MenuItem Header="Данные" Foreground="White" FontWeight="SemiBold">
                <MenuItem Header="Сгенерировать тестовую функцию" Background="#FF0078D7" 
                          Click="GenerateTestFunction_Click"/>
            </MenuItem>
            <MenuItem Header="Расчет" Foreground="White" FontWeight="SemiBold">
                <MenuItem Header="Запустить расчет" Background="#FF0078D7" 
                          Click="CalculateButton_Click"/>
                <MenuItem Header="Остановить расчет" Background="#FF0078D7" 
                          Click="StopCalculationButton_Click"/>
            </MenuItem>
            <MenuItem Header="Справка" Foreground="White" FontWeight="SemiBold">
                <MenuItem Header="О программе" Background="#FF0078D7" Click="AboutButton_Click"/>
            </MenuItem>
        </Menu>

        <!-- Заголовок -->
        <TextBlock Grid.Row="1" Text="Вычисление определенного интеграла" 
                   FontSize="18" FontWeight="Bold" Margin="0,10,0,5" 
                   HorizontalAlignment="Center" Foreground="#FF0078D7"/>

        <!-- Блок ввода данных -->
        <GroupBox Grid.Row="2" Header="Входные данные" FontWeight="SemiBold" 
                  BorderBrush="#FF0078D7" BorderThickness="1" Margin="0,5">
            <Grid Margin="8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Функция -->
                <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,3">
                    <TextBlock Text="Функция f(x):" Margin="0,0,0,3"/>
                    <TextBox Name="FunctionTextBox" Text="pow(x,2)" Height="22" FontSize="12"
                             ToolTip="Примеры: pow(x,2), sin(x), exp(x), x*cos(x)"/>
                </StackPanel>

                <!-- Интервал -->
                <StackPanel Grid.Row="0" Grid.Column="1" Margin="8,3">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Интервал [a, b]:" Margin="0,0,8,3"/>
                        <TextBox Name="ATextBox" Text="0" Width="50" Height="22" FontSize="12" Margin="0,0,3,3"/>
                        <TextBlock Text="до" Margin="3,0,3,3"/>
                        <TextBox Name="BTextBox" Text="1" Width="50" Height="22" FontSize="12" Margin="0,0,0,3"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                        <TextBlock Text="Точность ε:" Margin="0,0,8,0"/>
                        <TextBox Name="EpsilonTextBox" Text="0.001" Width="70" Height="22" FontSize="12"/>
                    </StackPanel>
                </StackPanel>

                <!-- Разбиения -->
                <StackPanel Grid.Row="0" Grid.Column="2" Margin="8,3">
                    <TextBlock Text="Количество разбиений n:" Margin="0,0,0,3"/>
                    <TextBox Name="NTextBox" Text="100" Width="70" Height="22" FontSize="12"/>
                    <CheckBox Name="AutoNCheckBox" Content="Автоматически находить оптимальное n" 
                              Margin="0,8,0,0" Checked="AutoNCheckBox_Checked"
                              Unchecked="AutoNCheckBox_Unchecked" FontSize="12"/>
                </StackPanel>

                <!-- Выбор методов -->
                <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3" Margin="0,10,0,0">
                    <TextBlock Text="Выберите методы расчета:" Margin="0,0,0,3" FontSize="12"/>
                    <WrapPanel>
                        <CheckBox Name="RectLeftCheckBox" Content="Прямоугольники (левый)" 
                                  Margin="8,3" VerticalAlignment="Center" FontSize="12"/>
                        <CheckBox Name="RectMiddleCheckBox" Content="Прямоугольники (средний)" 
                                  Margin="8,3" VerticalAlignment="Center" FontSize="12"/>
                        <CheckBox Name="RectRightCheckBox" Content="Прямоугольники (правый)" 
                                  Margin="8,3" VerticalAlignment="Center" FontSize="12"/>
                        <CheckBox Name="TrapezoidalCheckBox" Content="Метод трапеций" 
                                  Margin="8,3" VerticalAlignment="Center" FontSize="12"/>
                        <CheckBox Name="SimpsonCheckBox" Content="Метод Симпсона" 
                                  Margin="8,3" VerticalAlignment="Center" FontSize="12"/>
                    </WrapPanel>
                </StackPanel>

                <!-- Кнопка расчета -->
                <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3" 
                            HorizontalAlignment="Center" Margin="0,15,0,0">
                    <Button Name="CalculateButton" Content="Рассчитать" 
                            Width="180" Height="30" FontWeight="Bold" FontSize="13"
                            Background="#FF0078D7" Foreground="White"
                            Click="CalculateButton_Click"/>
                </StackPanel>
            </Grid>
        </GroupBox>

        <!-- Основной контент: график и результаты -->
        <Grid Grid.Row="3" Margin="0,10,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="320"/>
            </Grid.ColumnDefinitions>

            <!-- График (основное пространство) -->
            <Border Grid.Column="0" Margin="0,0,5,0" BorderBrush="Gray" BorderThickness="1" Padding="3">
                <Grid>
                    <Canvas Name="PlotCanvas" Background="White"/>
                    <TextBlock Name="NoPlotText" Text="График будет построен после расчета" 
                               HorizontalAlignment="Center" VerticalAlignment="Center"
                               Foreground="Gray" FontSize="14"/>
                </Grid>
            </Border>

            <!-- Результаты (компактная панель) -->
            <Border Grid.Column="1" BorderBrush="#FF0078D7" BorderThickness="1" Padding="5">
                <DockPanel>
                    <TextBlock Text="Результаты расчета" FontWeight="Bold" FontSize="13" 
                               Foreground="#FF0078D7" Margin="0,0,0,8" DockPanel.Dock="Top"/>

                    <ScrollViewer VerticalScrollBarVisibility="Auto" 
                                  HorizontalScrollBarVisibility="Disabled"
                                  Margin="0,0,0,5">
                        <StackPanel Name="ResultsPanel">
                            <!-- Результаты будут добавляться динамически -->
                        </StackPanel>
                    </ScrollViewer>

                    <!-- Статус и прогресс -->
                    <Border BorderBrush="LightGray" BorderThickness="1" Padding="5" 
                            Background="#F5F5F5" DockPanel.Dock="Bottom">
                        <StackPanel>
                            <TextBlock Name="StatusText" Text="Готов к работе" 
                                       Foreground="Green" FontWeight="SemiBold" 
                                       HorizontalAlignment="Center" Margin="0,0,0,3"/>
                            <ProgressBar Name="CalculationProgress" Height="15" 
                                         Minimum="0" Maximum="100" Visibility="Collapsed"
                                         Margin="0,0,0,3"/>
                            <TextBlock Name="ProgressText" Text="" HorizontalAlignment="Center" 
                                       Foreground="Gray" FontSize="11"/>
                        </StackPanel>
                    </Border>
                </DockPanel>
            </Border>
        </Grid>

        <!-- Лог и история (нижняя панель) -->
        <Grid Grid.Row="4" Margin="0,10,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Лог вычислений -->
            <Border Grid.Column="0" BorderBrush="LightGray" BorderThickness="1">
                <DockPanel>
                    <TextBlock Text="Лог вычислений" FontWeight="Bold" FontSize="12" 
                               Margin="5,3,5,3" DockPanel.Dock="Top"/>
                    <ScrollViewer VerticalScrollBarVisibility="Auto" 
                                  HorizontalScrollBarVisibility="Auto">
                        <TextBox Name="LogTextBox" IsReadOnly="True" BorderThickness="0" 
                                 Background="White" FontFamily="Consolas" FontSize="10"
                                 TextWrapping="Wrap" Padding="5"/>
                    </ScrollViewer>
                </DockPanel>
            </Border>

            <!-- Разделитель -->
            <GridSplitter Grid.Column="1" Width="3" HorizontalAlignment="Center"
                          Background="LightGray" ShowsPreview="True"/>

            <!-- История разбиений -->
            <Border Grid.Column="2" BorderBrush="LightGray" BorderThickness="1">
                <DockPanel>
                    <TextBlock Text="История подбора разбиений" FontWeight="Bold" FontSize="12"
                               Margin="5,3,5,3" DockPanel.Dock="Top"/>
                    <ScrollViewer VerticalScrollBarVisibility="Auto" 
                                  HorizontalScrollBarVisibility="Auto">
                        <StackPanel Name="HistoryPanel">
                            <!-- История будет добавляться динамически -->
                        </StackPanel>
                    </ScrollViewer>
                </DockPanel>
            </Border>
        </Grid>
    </Grid>
</Window>