<Window x:Class="MultiWindowApp.IntegralCalculator"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Вычисление определенного интеграла - Лабораторная работа №5" 
        Height="800" Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="White"
        Closing="Window_Closing">

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Меню -->
        <Menu Grid.Row="0" Background="#FF0078D7" Padding="0">
            <MenuItem Header="Файл" Foreground="White" FontWeight="SemiBold">
                <MenuItem Header="Очистить" Background="#FF0078D7" Click="ClearButton_Click"/>
                <Separator/>
                <MenuItem Header="Выход" Background="#FF0078D7" Click="ExitButton_Click"/>
            </MenuItem>
            <MenuItem Header="Данные" Foreground="White" FontWeight="SemiBold">
                <MenuItem Header="Сгенерировать тестовую функцию" Background="#FF0078D7" 
                          Click="GenerateTestFunction_Click"/>
            </MenuItem>
            <MenuItem Header="Расчет" Foreground="White" FontWeight="SemiBold">
                <MenuItem Header="Запустить расчет" Background="#FF0078D7" 
                          Click="CalculateButton_Click"/>
                <MenuItem Header="Остановить расчет" Background="#FF0078D7" 
                          Click="StopCalculationButton_Click"/>
            </MenuItem>
            <MenuItem Header="Справка" Foreground="White" FontWeight="SemiBold">
                <MenuItem Header="О программе" Background="#FF0078D7" Click="AboutButton_Click"/>
            </MenuItem>
        </Menu>

        <!-- Заголовок -->
        <TextBlock Grid.Row="1" Text="Вычисление определенного интеграла" 
                   FontSize="18" FontWeight="Bold" Margin="0,15,0,10" 
                   HorizontalAlignment="Center" Foreground="#FF0078D7"/>

        <!-- Блок ввода данных -->
        <GroupBox Grid.Row="2" Header="Входные данные" FontWeight="SemiBold" 
                  BorderBrush="#FF0078D7" BorderThickness="1" Margin="0,5">
            <Grid Margin="10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Функция -->
                <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,5">
                    <TextBlock Text="Функция f(x):" Margin="0,0,0,5"/>
                    <TextBox Name="FunctionTextBox" Text="pow(x,2)" Height="25" 
         ToolTip="Примеры: pow(x,2), sin(x), exp(x), x*cos(x). Используйте pow(x,y) для возведения в степень"/>
                </StackPanel>

                <!-- Интервал -->
                <StackPanel Grid.Row="0" Grid.Column="1" Margin="10,5">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Интервал [a, b]:" Margin="0,0,10,5"/>
                        <TextBox Name="ATextBox" Text="0" Width="60" Margin="0,0,5,5"/>
                        <TextBlock Text="до" Margin="5,0,5,5"/>
                        <TextBox Name="BTextBox" Text="1" Width="60" Margin="0,0,0,5"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Точность ε:" Margin="0,0,10,0"/>
                        <TextBox Name="EpsilonTextBox" Text="0.001" Width="80"/>
                    </StackPanel>
                </StackPanel>

                <!-- Разбиения -->
                <StackPanel Grid.Row="0" Grid.Column="2" Margin="10,5">
                    <TextBlock Text="Количество разбиений n:" Margin="0,0,0,5"/>
                    <TextBox Name="NTextBox" Text="100" Width="80" Height="25"/>
                    <CheckBox Name="AutoNCheckBox" Content="Автоматически находить оптимальное n" 
                              Margin="0,10,0,0" Checked="AutoNCheckBox_Checked"
                              Unchecked="AutoNCheckBox_Unchecked"/>
                </StackPanel>

                <!-- Выбор методов -->
                <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3" Margin="0,15,0,0">
                    <TextBlock Text="Выберите методы расчета:" Margin="0,0,0,5"/>
                    <WrapPanel>
                        <CheckBox Name="RectLeftCheckBox" Content="Прямоугольники (левый)" 
                                  Margin="10,5" VerticalAlignment="Center"/>
                        <CheckBox Name="RectMiddleCheckBox" Content="Прямоугольники (средний)" 
                                  Margin="10,5" VerticalAlignment="Center"/>
                        <CheckBox Name="RectRightCheckBox" Content="Прямоугольники (правый)" 
                                  Margin="10,5" VerticalAlignment="Center"/>
                        <CheckBox Name="TrapezoidalCheckBox" Content="Метод трапеций" 
                                  Margin="10,5" VerticalAlignment="Center"/>
                        <CheckBox Name="SimpsonCheckBox" Content="Метод Симпсона" 
                                  Margin="10,5" VerticalAlignment="Center"/>
                    </WrapPanel>
                </StackPanel>

                <!-- Кнопка расчета -->
                <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3" 
                            HorizontalAlignment="Center" Margin="0,20,0,0">
                    <Button Name="CalculateButton" Content="Рассчитать" 
                            Width="200" Height="35" FontWeight="Bold"
                            Background="#FF0078D7" Foreground="White"
                            Click="CalculateButton_Click"/>
                </StackPanel>
            </Grid>
        </GroupBox>

        <!-- Блок результатов и графика -->
        <GroupBox Grid.Row="3" Header="Результаты и визуализация" FontWeight="SemiBold" 
                  BorderBrush="#FF0078D7" BorderThickness="1" Margin="0,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="300"/>
                </Grid.ColumnDefinitions>

                <!-- График -->
                <Border Grid.Column="0" Margin="5" BorderBrush="Gray" BorderThickness="1" Padding="5">
                    <Grid>
                        <Canvas Name="PlotCanvas" Background="White"/>
                        <TextBlock Name="NoPlotText" Text="График будет построен после расчета" 
                                   HorizontalAlignment="Center" VerticalAlignment="Center"
                                   Foreground="Gray" FontSize="14"/>
                    </Grid>
                </Border>

                <!-- Результаты -->
                <StackPanel Grid.Column="1" Margin="5">
                    <TextBlock Text="Результаты расчета:" FontWeight="Bold" Margin="0,0,0,10"/>

                    <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="400">
                        <StackPanel Name="ResultsPanel">
                            <!-- Результаты будут добавляться динамически -->
                        </StackPanel>
                    </ScrollViewer>

                    <TextBlock Text="Лог вычислений:" FontWeight="Bold" Margin="0,20,0,10"/>
                    <Border BorderBrush="LightGray" BorderThickness="1" Height="150">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <TextBox Name="LogTextBox" IsReadOnly="True" BorderThickness="0" 
                                     Background="White" FontFamily="Consolas" FontSize="10"/>
                        </ScrollViewer>
                    </Border>
                </StackPanel>
            </Grid>
        </GroupBox>

        <!-- Статус и прогресс -->
        <Border Grid.Row="4" BorderBrush="#FF0078D7" BorderThickness="1" Margin="0,10" Padding="10">
            <StackPanel>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <TextBlock Name="StatusText" Text="Готов к работе" Foreground="Green" 
                               FontWeight="SemiBold" Margin="0,0,20,0"/>
                    <ProgressBar Name="CalculationProgress" Width="300" Height="20" 
                                 Minimum="0" Maximum="100" Visibility="Collapsed"/>
                </StackPanel>
                <TextBlock Name="ProgressText" Text="" HorizontalAlignment="Center" 
                           Margin="0,5,0,0" Foreground="Gray"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>